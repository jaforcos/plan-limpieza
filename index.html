<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <title>Plan de limpieza familiar</title>

  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#2f7dd6" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <!-- (Opcional) Mejor apariencia en iOS si lo aÃ±ades a pantalla de inicio:
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  -->
</head>

<body>
<header class="app-header">
  <div class="brand">
    <div class="logo">ğŸ§½</div>
    <div>
      <h1>Plan de limpieza</h1>
      <p class="subtitle">FÃ¡cil para todos Â· Marca âœ” y listo</p>
    </div>
  </div>

  <div class="controls">
    <div class="control">
      <label>ğŸ“… Fecha</label>
      <input id="startDateText" type="text" inputmode="numeric" placeholder="dd/mm/aaaa" maxlength="10" />
      <small>Desde 07/02/2026</small>
    </div>

    <div class="control">
      <label>ğŸŒ€ SÃ¡bado</label>
      <select id="rotation">
        <option value="AUTO">AutomÃ¡tica</option>
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
        <option value="D">D</option>
      </select>
      <small id="rotationHint">â€”</small>
    </div>

    <div class="control buttons">
      <button id="btnToday" type="button">ğŸ  HOY</button>
    </div>
  </div>
</header>

<main class="container">
  <div class="kid-note">
    âœ¨ <b>Muy fÃ¡cil:</b> toca un nombre para ver sus tareas. Marca âœ” cuando termines.
  </div>

  <section class="panel active">
    <div id="dayContent"></div>
  </section>

  <section id="panel-extras" class="panel">
    <div class="panel-header">
      <h2>â­ Extras</h2>
      <p class="muted">Una vez al mes</p>
    </div>
    <div id="extrasContent"></div>
  </section>

  <section id="panel-ajustes" class="panel">
    <div class="panel-header"><h2>âš™ Ajustes</h2></div>
    <div class="cards">
      <div class="card">
        <h3>Exportar</h3>
        <button id="btnExport" type="button">Exportar</button>
      </div>
      <div class="card">
        <h3>Importar</h3>
        <input id="importFile" type="file" accept="application/json" />
      </div>
      <div class="card danger">
        <h3>Reiniciar</h3>
        <button id="btnReset" type="button">Reiniciar</button>
      </div>
    </div>
  </section>
</main>

<nav class="bottom-nav">
  <button class="nav-btn active" data-tab="day">DÃ­a</button>
  <button class="nav-btn" data-tab="extras">Extras</button>
  <button class="nav-btn" data-tab="ajustes">âš™</button>
</nav>

<!-- 1) Tus datos (PLAN_DATA) -->
<script src="data.js"></script>

<!-- 2) Firebase (CDN) + Promesa global para evitar carreras -->
<script type="module">
  // Creamos una promesa global que se resolverÃ¡ cuando Firebase estÃ© listo
  window.FB_READY = (async () => {
    // Imports desde CDN (vÃ¡lidos en GitHub Pages / web estÃ¡tica)
    const [{ initializeApp }, { getAuth, signInAnonymously }, { getFirestore }, { getAnalytics }] =
      await Promise.all([
        import("https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"),
        import("https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"),
        import("https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"),
        import("https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js")
      ]);

    // ConfiguraciÃ³n Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBNVzJEDDwPEq6WhJDnscrfMzZFMjykkDE",
      authDomain: "plan-de-limpieza-2026.firebaseapp.com",
      projectId: "plan-de-limpieza-2026",
      storageBucket: "plan-de-limpieza-2026.firebasestorage.app",
      messagingSenderId: "575163614718",
      appId: "1:575163614718:web:3b467d335e459bb3ff6caf",
      measurementId: "G-EMHZEHVQ78"
    };

    // Inicializa Firebase
    const app = initializeApp(firebaseConfig);

    // Analytics (opcional; en algunos entornos puede fallar â†’ no rompemos la app)
    let analytics = null;
    try { analytics = getAnalytics(app); } catch (e) { console.warn("Analytics no disponible:", e); }

    // Auth anÃ³nimo
    const auth = getAuth(app);
    await signInAnonymously(auth);

    // Firestore
    const db = getFirestore(app);

    // Exponemos a tu app
    window.FB = { app, auth, db, analytics };
    return window.FB;
  })();

  // Si falla Firebase, lo dejamos claro en consola
  window.FB_READY.catch(err => {
    console.error("âŒ Error inicializando Firebase:", err);
  });
</script>

<!-- 3) Tu app (ES IMPORTANTE que sea type=module) -->
<script type="module" src="app.js"></script>

</body>
</html>
